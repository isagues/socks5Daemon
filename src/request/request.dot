digraph hello {
    rankdir=LR;
    size= "8.27,11.69";

    node                              [shape = circle];

    VERSION                           [label = "version"];
    COMMAND                           [label = "command"];
    RESERVED                          [label = "reserved"];
    ADD_TYPE                          [label = "address\ntype"];
    DOMAIN_LENGTH                     [label = "domain\nlength"];
    ADDRESS                           [label = "address"];
    PORT_HIGH                         [label = "port\nhigh"];
    PORT_LOW                          [label = "port\nlow"];
    SUCCESS                           [label = "done", shape = doublecircle];
    E_UNS_VERSION                     [label = "not\nsupported\nversion", shape = doublecircle];
    E_UNS_COMMAND                     [label = "not\nsupported\ncommand", shape = doublecircle];
    E_UNS_ADD_TYPE                    [label = "not\nsupported\naddress\ntype", shape = doublecircle];

    VERSION -> E_UNS_VERSION          [label= "!= '05'"];
    VERSION -> COMMAND                [label="'05'"];
    COMMAND -> E_UNS_COMMAND          [label= "!= '01'"];
    COMMAND -> RESERVED               [label= "'01'"];
    RESERVED -> ADD_TYPE              [label= "ANY"];
    ADD_TYPE -> E_UNS_ADD_TYPE        [label= "NOT IN { '01', '03' }"];
    ADD_TYPE -> DOMAIN_LENGTH         [label= "'03'"];
    ADD_TYPE -> ADDRESS               [label= "'01'\nn = 4"];
    DOMAIN_LENGTH -> ADDRESS          [label= "b > 0\nn = b"];
    DOMAIN_LENGTH -> PORT_HIGH        [label= "'00'"];
    ADDRESS -> ADDRESS                [label= "n--;\nn > 0"];
    ADDRESS -> PORT_HIGH              [label= "n--;\nn == 0"];
    PORT_HIGH -> PORT_LOW             [label="ANY"];
    PORT_LOW -> SUCCESS               [label= "ANY"];

    SUCCESS -> SUCCESS                [label= "ANY"];
    E_UNS_VERSION -> E_UNS_VERSION    [label= "ANY"];
    E_UNS_COMMAND -> E_UNS_COMMAND    [label= "ANY"];
    E_UNS_ADD_TYPE -> E_UNS_ADD_TYPE  [label= "ANY"];
}